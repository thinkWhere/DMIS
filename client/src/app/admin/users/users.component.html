<div id="users-component">
    <h2>Users</h2>
    <a routerLink="/admin/user/add" role="button" class="btn btn-primary pull-right">Add user</a>
    <table class="table table-hover">
        <thead>
        <tr>
            <th>Username</th>
            <th>Role</th>
            <th></th>
            <th></th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let user of userList; index as i;" [class.selected]="user === selectedUser">
            <td>{{ user.username }}</td>
            <td *ngIf="!editMode || user.username != editUsername">{{ user.role }}</td>
            <td *ngIf="editMode && user.username == editUsername">
                <select id="role" class="form-control"
                name="role"
                [(ngModel)]="user.role" required
                #role="ngModel" >
                  <option value="USER">User</option>
                  <option value="ADMIN">Admin</option>
                </select>
            </td>
            <td *ngIf="!editMode" class="pointer" (click)="editUser(user.username); $event.stopPropagation()">
                <a class="btn btn-xs btn-primary"><i class="fa fa-pencil" aria-hidden="true"></i> Edit</a></td>
            <td *ngIf="editMode" class="pointer" (click)="saveEdits(user.username, user.role); $event.stopPropagation()">
                <a class="btn btn-xs btn-primary"><i class="fa fa-save" aria-hidden="true"></i> Save</a></td>
            <td class="pointer" data-target="#myModal" data-toggle="modal" (click)="showDeleteConfirm(true, user);">
                <a class="btn btn-xs btn-primary"><i class="fa fa-trash" aria-hidden="true"></i> Delete</a></td>
        </tr>
        </tbody>
    </table>
    <div *ngIf="errorDeletingUser" class="alert alert-danger">
        <strong>Error: </strong> could not delete the user.
    </div>
</div>

<!-- Delete confirmation modal -->
<div class="modal fade" id="myModal" role="dialog" [hidden]="!showDeleteConfirmModal">
    <div class="modal-dialog modal-sm">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Delete confirmation</h4>
        </div>
        <div class="modal-body">
          <p>Are you sure you want to delete this user?</p>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-primary" (click)="deleteUser(userToDelete)" data-dismiss="modal">Confirm</button>
        </div>
      </div>
    </div>
</div>